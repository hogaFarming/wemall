{"version":3,"sources":["webpack:///src/views/cart/cart.vue","webpack:///./src/views/cart/cart.vue?b9f2","webpack:///./src/views/cart/cart.vue","webpack:///./src/views/cart/cart.vue?1eda","webpack:///./src/views/cart/cart.vue?15a9"],"names":["cart","_this","this","isValidGoods","_this2","sale_price","_loop","key","total","pageInit","fetchCartList","_this3","list","message","_this4","swiped","close","isEdit","picked","number","stopPropagation","_this5","id","then","res","item","_this6","url","goods_id","_this7","sku_id","skus","num","_this8","skuValue","skuModel","amount","hideSku","_this9","skuId","sku","image","stock","_this10","_this11","data","property","name","goods_title","skuImg","getPickedIds","getPickedItems","_this12","i","k","ids","cart_cart","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","error","attrs","bordered","slot","on","click","toggleEdit","_l","touchstart","swipeGuard","model","value","callback","$$v","$set","expression","_e","$event","showSku","gotoDetail","staticStyle","width","height","src","cover","alt","_f","goods_status","color","theme","max","disabled","input","numberChange","onRemoveButtonTouch","remove","type","isAllPicked","togglePickAll","totalAmount","font-size","nativeOn","removeAll","gotoPay","visible","skuCartItem","sku-model","buttons","visible-change","skuVisibleChange","confirm","onSkuConfirm","margin-bottom","inline","pill","$router","push","path","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","content","module","locals","exports","version","sources","names","mappings","file","sourcesContent","sourceRoot"],"mappings":"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","file":"static/js/4.95917a5f33b387f79097.js","sourcesContent":["<template>\n  <div class=\"page cart-page\">\n    <template v-if=\"loading\">加载中...</template>\n    <template v-else-if=\"error\">{{ error }}</template>\n    <template v-else-if=\"list.length\">\n      <x-cell class=\"fs-me\" bordered>\n        <span class=\"black-3\">全部商品</span>\n        <span @click=\"toggleEdit\" slot=\"right\">{{ isEdit ? '完成' : '编辑' }}</span>\n      </x-cell>\n      <div class=\"cart-item-group swipe-cell-list\">\n        <div class=\"cart-item swipe-cell-item bdb pd\" v-for=\"item in list\" :key=\"item.id\" @touchstart=\"swipeGuard\">\n          <div class=\"swipe-cell-content\">\n            <x-checkbox v-if=\"isEdit || isValidGoods(item)\" class=\"cart-item-checkbox\" v-model=\"picked[item.id]\"></x-checkbox>\n            <x-media-object class=\"cart-item-content\">\n              <div @click=\"isEdit ? showSku(item) : gotoDetail(item)\">{{ item.goods_title }}</div>\n              <div class=\"image\" style=\"width: 2.4rem;height: 2.4rem;\" slot=\"left\" @click=\"isEdit ? showSku(item) : gotoDetail(item)\">\n                <img :src=\"item.cover\" alt=\"图片\">\n                <div class=\"image-text\" v-if=\"!isValidGoods(item)\">{{ item.goods_status | goodsStatus }}</div>\n              </div>\n              <span slot=\"secondary\">{{ item.property }}</span>\n              <x-money slot=\"bottom-left\" color=\"red\" :value=\"item.sale_price\"></x-money>\n              <x-number-input\n                slot=\"bottom-right\"\n                v-if=\"isEdit\"\n                theme=\"light\"\n                :value=\"item.num\"\n                :max=\"item.stock\"\n                :disabled=\"!isValidGoods(item)\"\n                @input=\"numberChange(item, $event)\">\n              </x-number-input>\n              <span slot=\"bottom-right\" v-else>x{{ item.num }}</span>\n            </x-media-object>\n          </div>\n          <div class=\"swipe-cell-right\" @touchstart=\"onRemoveButtonTouch($event)\" @click=\"remove(item)\">\n            <x-button class=\"cart-item-remove\" type=\"danger\">删除</x-button>\n          </div>\n        </div>\n      </div>\n      <!--底部按钮-->\n      <x-fixed-bottom bordered>\n        <x-cell slot=\"content\" class=\"fs-me\">\n          <x-checkbox :value=\"isAllPicked\" @input=\"togglePickAll\"></x-checkbox>\n          <span>全选</span>\n          <div slot=\"right\">合计：<x-money :value=\"totalAmount\" color=\"red\"></x-money></div>\n        </x-cell>\n        <x-button v-if=\"isEdit\" type=\"danger\" @click.native=\"removeAll\" style=\"font-size: 16px;\">删&nbsp;&nbsp;&nbsp;除</x-button>\n        <x-button v-else type=\"primary\" @click.native=\"gotoPay\" style=\"font-size: 16px;\">去结账</x-button>\n      </x-fixed-bottom>\n      <!--sku组件-->\n      <prod-sku\n        :visible=\"!!skuCartItem\"\n        @visible-change=\"skuVisibleChange\"\n        v-model=\"skuValue\"\n        :sku-model=\"skuModel\"\n        @confirm=\"onSkuConfirm\"\n        :buttons=\"['confirm']\">\n      </prod-sku>\n    </template>\n    <template v-else>\n      <p class=\"cart-page-empty\">\n        <img src=\"/static/icon/img_shopping_cart.png\" alt=\"没有商品\" style=\"margin-bottom: 10px;\">\n        <br>\n        <span>购物车空空的哟～您可以</span>\n        <br><br>\n        <x-button @click.native=\"$router.push({ path: '/product/list' })\" type=\"primary\" inline pill>随便逛逛</x-button>\n      </p>\n    </template>\n\n    <!--<x-cell bordered>-->\n      <!--<x-checkbox :checked=\"true\" @change=\"togglePick('id')\"></x-checkbox>-->\n      <!--<span style=\"margin-left: 5px;\">组合套装</span>-->\n    <!--</x-cell>-->\n    <!--<x-media-object pic=\"/static/img/order.png\" bordered padding>-->\n      <!--2017年新款茶灵春季面膜50ml 提亮肌肤快速美容透白美丽快速美容-->\n      <!--<span slot=\"secondary\">提亮肌肤50ML</span>-->\n      <!--<x-money slot=\"bottom-left\" color=\"red\" :value=\"588\"></x-money>-->\n      <!--<x-number-input slot=\"bottom-right\" v-if=\"isEdit\" theme=\"light\"></x-number-input>-->\n      <!--<span slot=\"bottom-right\" v-else>x1</span>-->\n    <!--</x-media-object>-->\n    <!--<x-cell>-->\n      <!--<span>套装价格: &nbsp;<x-money :value=\"688\"></x-money></span>-->\n      <!--<x-number-input slot=\"bottom-right\" v-if=\"isEdit\" theme=\"light\"></x-number-input>-->\n    <!--</x-cell>-->\n\n  </div>\n</template>\n<script>\n  export default {\n    data () {\n      return {\n        error: '',\n        loading: true,\n        list: [],\n        isEdit: false,\n        picked: {},\n        numbers: {},\n        skuModelCache: {},\n        skuModel: null,\n        skuValue: null,\n        skuCartItem: null\n      }\n    },\n    computed: {\n      isAllPicked () {\n        const list = this.isEdit ? this.list : this.list.filter(this.isValidGoods)\n        return list.length > 0 && list.every(item => {\n          return this.isValidGoods(item) ? this.picked[item.id] : true\n        })\n      },\n      totalAmount () {\n        let total = 0\n        for (let key in this.picked) {\n          if (this.picked[key]) {\n            const item = this.list.filter(i => i.id === +key)[0]\n            if (!item) continue\n            total += item.num * (item.is_comb ? item.total_price : item.sale_price)\n          }\n        }\n        return total\n      }\n    },\n    mounted () {\n      this.pageInit()\n    },\n    methods: {\n      pageInit () {\n        this.fetchCartList()\n      },\n      fetchCartList () {\n        this.$http.withLoading('/api/goods/carts').then(res => {\n          this.loading = false\n          this.list = res.list\n          // this.list[0].goods_status = 2\n          // this.list[1].stock = 3\n          this.$nextTick(() => {\n            this.swiped = window.Swiped.init({\n              query: '.cart-item-group .cart-item',\n              list: true,\n              right: 100\n            })\n          })\n        }, err => {\n          this.loading = false\n          this.error = err.message\n        })\n      },\n      toggleEdit () {\n        if (this.isEdit) {\n          // 去掉picked中失效商品\n          this.list.forEach(item => {\n            if (!this.isValidGoods(item) && this.picked[item.id]) {\n              this.picked[item.id] = false\n            }\n          })\n          if (this.swiped) {\n            const swiped = Array.isArray(this.swiped) ? this.swiped : [this.swiped]\n            swiped.forEach(s => s.close())\n          }\n        }\n        this.isEdit = !this.isEdit\n      },\n      // togglePick (item) {\n      //   if (!this.isEdit && !this.isValidGoods(item)) return\n      //   this.picked = {\n      //     ...this.picked,\n      //     [item.id]: true\n      //   }\n      //   // this.picked[item.id] = true\n      // },\n      togglePickAll (val) {\n        const picked = {}\n        if (val) {\n          const list = this.isEdit ? this.list : this.list.filter(this.isValidGoods)\n          list.forEach(item => { picked[item.id] = true })\n        }\n        this.picked = picked\n      },\n      numberChange (item, number) {\n        // item.num = number >= item.stock ? item.stock : number\n        this.modifyCartNum(item, number)\n      },\n      swipeGuard (event) {\n        if (!this.isEdit) {\n          event.stopPropagation()\n        }\n      },\n      onRemoveButtonTouch (event, item) {\n        event.stopPropagation() // 阻止swiped插件默认回弹行为!!\n      },\n      remove (item) {\n        this.$messagebox.confirm('确认删除？').then(result => {\n          if (result === 'cancel') return\n          this.$http.withLoading({\n            url: `/api/goods/carts/${item.id}`,\n            method: 'delete'\n          }).then(res => {\n            this.$toast('删除成功')\n            this.list = this.list.filter(i => i !== item)\n          })\n        })\n      },\n      removeAll () {\n        const ids = []\n        for (let key in this.picked) {\n          if (this.picked[key]) ids.push(+key)\n        }\n        if (!ids.length) {\n          this.$toast('未选中商品')\n          return\n        }\n        this.$messagebox.confirm('确认删除？').then(result => {\n          if (result === 'cancel') return\n          this.$http.withLoading({\n            url: `/api/cart/batches`,\n            data: { cart_id: ids.map(id => ({ cart_id: id })) },\n            method: 'put'\n          }).then(res => {\n            this.$toast('删除成功')\n            this.list = this.list.filter(i => ids.indexOf(i.id) === -1)\n          })\n        })\n      },\n      gotoDetail (item) {\n        this.$router.push(`/product/${item.goods_id}`)\n      },\n      showSku (item) {\n        if (!item.is_sku) return\n        if (this.skuModelCache[item.goods_id]) {\n          this._showSku(item)\n        } else {\n          this.fetchItemSkus(item).then(() => this._showSku(item))\n        }\n      },\n      _showSku (item) {\n        // 初始化skuValue,skuModel\n        this.skuModel = this.skuModelCache[item.goods_id]\n        this.skuValue = {\n          skuId: item.sku_id,\n          selectedProps: this.$utils.skuTool.getSelectedProps(item.sku_id, this.skuModel.skus),\n          amount: item.num\n        }\n        this.skuCartItem = item\n      },\n      onSkuConfirm () {\n        const { skuCartItem, skuValue, skuModel } = this\n        if (!skuValue.skuId) return this.$toast('请选择规格')\n        if (!skuValue.amount) return this.$toast('请选择数量')\n\n        this.modifyCartSku(skuCartItem, skuValue, skuModel)\n          .then(() => {\n            this.modifyCartNum(skuCartItem, skuValue.amount)\n          })\n\n        this.hideSku()\n      },\n      modifyCartSku (cartItem, skuValue, skuModel) {\n        if (cartItem.sku_id === skuValue.skuId) return Promise.resolve({ cartItem, skuValue })\n        return this.$http.withLoading({\n          url: `/api/goods/cart/skus/${cartItem.id}`,\n          data: { sku_id: skuValue.skuId },\n          method: 'put'\n        }).then(res => {\n          // TODO 修改cartItem图片\n          cartItem.sku_id = skuValue.skuId\n          const sku = this.$utils.skuTool.getSelectedSku(skuValue, skuModel)\n          if (sku) {\n            cartItem.property = this.$utils.skuTool.getSkuText(sku)\n            cartItem.cover = sku.image\n            cartItem.sale_price = sku.sale_price\n            cartItem.stock = sku.stock\n          }\n        })\n      },\n      modifyCartNum (cartItem, num) {\n        this.$http.withLoading({\n          url: `/api/goods/carts/${cartItem.id}`,\n          data: {\n            num: num,\n            add_or_less: num - cartItem.num < 0 ? 0 : 1\n          },\n          method: 'put'\n        }).then(res => {\n          cartItem.num = num\n        })\n      },\n      skuVisibleChange (visible) {\n        if (!visible) {\n          this.hideSku()\n        }\n      },\n      hideSku () {\n        this.skuCartItem = null\n        this.$nextTick(() => {\n          this.skuModel = null\n          this.skuValue = null\n        })\n      },\n      fetchItemSkus (item) {\n        return this.$http.withLoading(`/api/goodses/${item.goods_id}`).then(result => {\n          const data = result.data\n          this.goodsInfo = data\n          let skuImg = data.images.filter(item => item.is_default)[0] || data.images[0]\n          skuImg = skuImg ? skuImg.path : ''\n          this.skuModelCache[item.goods_id] = {\n            property: data.property,\n            skus: data.skus,\n            goodsInfo: {\n              name: data.name,\n              title: data.goods_title,\n              image: skuImg\n            }\n          }\n        })\n      },\n      gotoPay () {\n        const ids = this.getPickedIds()\n        if (!ids.length) {\n          return this.$toast('未选中商品')\n        }\n        // 校验数量是否超出库存\n        const items = this.getPickedItems()\n        if (items.some(i => i.num > i.stock)) {\n          return this.$toast('部分商品超出库存')\n        }\n        this.$router.push({ path: '/cart/order', query: { cart: ids.join(',') } })\n      },\n      getPickedItems () {\n        return this.getPickedIds().map(id => {\n          return this.list.filter(item => item.id === id)[0]\n        }).filter(i => !!i)\n      },\n      getPickedIds () {\n        const ids = []\n        for (let k in this.picked) {\n          if (this.picked[k]) {\n            ids.push(+k)\n          }\n        }\n        return ids\n      },\n      isValidGoods (item) {\n        return item.goods_status === 1\n      }\n    }\n  }\n</script>\n<style>\n  .cart-page {\n\n  }\n  .cart-page .x-icon.x-checkbox {\n    width: 20px;\n    height: 20px;\n  }\n  .cart-item {\n    position: relative;\n    background-color: #fff;\n  }\n  .cart-item-content {\n    margin-left: 0.86rem;\n  }\n  .cart-item .x-button.cart-item-remove {\n    height: 100%;\n    width: 100%;\n  }\n  .cart-item-checkbox {\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n  .swipe-cell-list {\n    overflow: hidden;\n  }\n  .swipe-cell-item {\n    position: relative;\n  }\n  .swipe-cell-content {\n    width: 100%;\n  }\n  .swipe-cell-right {\n    position: absolute;\n    left: 100%;\n    top: 0;\n    bottom: 0;\n    width: 100px;\n  }\n  .cart-page-empty {\n    text-align: center;\n    font-size: 14px;\n    color: #999999;\n    padding-top: 120px;\n  }\n  .cart-page-empty .x-button {\n    font-size: 16px;\n    padding: 0 0.48rem;\n    height: 0.8rem;\n    line-height: 0.8rem;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/cart/cart.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page cart-page\"},[(_vm.loading)?[_vm._v(\"加载中...\")]:(_vm.error)?[_vm._v(_vm._s(_vm.error))]:(_vm.list.length)?[_c('x-cell',{staticClass:\"fs-me\",attrs:{\"bordered\":\"\"}},[_c('span',{staticClass:\"black-3\"},[_vm._v(\"全部商品\")]),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"right\"},on:{\"click\":_vm.toggleEdit},slot:\"right\"},[_vm._v(_vm._s(_vm.isEdit ? '完成' : '编辑'))])]),_vm._v(\" \"),_c('div',{staticClass:\"cart-item-group swipe-cell-list\"},_vm._l((_vm.list),function(item){return _c('div',{key:item.id,staticClass:\"cart-item swipe-cell-item bdb pd\",on:{\"touchstart\":_vm.swipeGuard}},[_c('div',{staticClass:\"swipe-cell-content\"},[(_vm.isEdit || _vm.isValidGoods(item))?_c('x-checkbox',{staticClass:\"cart-item-checkbox\",model:{value:(_vm.picked[item.id]),callback:function ($$v) {_vm.$set(_vm.picked, item.id, $$v)},expression:\"picked[item.id]\"}}):_vm._e(),_vm._v(\" \"),_c('x-media-object',{staticClass:\"cart-item-content\"},[_c('div',{on:{\"click\":function($event){_vm.isEdit ? _vm.showSku(item) : _vm.gotoDetail(item)}}},[_vm._v(_vm._s(item.goods_title))]),_vm._v(\" \"),_c('div',{staticClass:\"image\",staticStyle:{\"width\":\"2.4rem\",\"height\":\"2.4rem\"},attrs:{\"slot\":\"left\"},on:{\"click\":function($event){_vm.isEdit ? _vm.showSku(item) : _vm.gotoDetail(item)}},slot:\"left\"},[_c('img',{attrs:{\"src\":item.cover,\"alt\":\"图片\"}}),_vm._v(\" \"),(!_vm.isValidGoods(item))?_c('div',{staticClass:\"image-text\"},[_vm._v(_vm._s(_vm._f(\"goodsStatus\")(item.goods_status)))]):_vm._e()]),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"secondary\"},slot:\"secondary\"},[_vm._v(_vm._s(item.property))]),_vm._v(\" \"),_c('x-money',{attrs:{\"slot\":\"bottom-left\",\"color\":\"red\",\"value\":item.sale_price},slot:\"bottom-left\"}),_vm._v(\" \"),(_vm.isEdit)?_c('x-number-input',{attrs:{\"slot\":\"bottom-right\",\"theme\":\"light\",\"value\":item.num,\"max\":item.stock,\"disabled\":!_vm.isValidGoods(item)},on:{\"input\":function($event){_vm.numberChange(item, $event)}},slot:\"bottom-right\"}):_c('span',{attrs:{\"slot\":\"bottom-right\"},slot:\"bottom-right\"},[_vm._v(\"x\"+_vm._s(item.num))])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"swipe-cell-right\",on:{\"touchstart\":function($event){_vm.onRemoveButtonTouch($event)},\"click\":function($event){_vm.remove(item)}}},[_c('x-button',{staticClass:\"cart-item-remove\",attrs:{\"type\":\"danger\"}},[_vm._v(\"删除\")])],1)])})),_vm._v(\" \"),_c('x-fixed-bottom',{attrs:{\"bordered\":\"\"}},[_c('x-cell',{staticClass:\"fs-me\",attrs:{\"slot\":\"content\"},slot:\"content\"},[_c('x-checkbox',{attrs:{\"value\":_vm.isAllPicked},on:{\"input\":_vm.togglePickAll}}),_vm._v(\" \"),_c('span',[_vm._v(\"全选\")]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"right\"},slot:\"right\"},[_vm._v(\"合计：\"),_c('x-money',{attrs:{\"value\":_vm.totalAmount,\"color\":\"red\"}})],1)],1),_vm._v(\" \"),(_vm.isEdit)?_c('x-button',{staticStyle:{\"font-size\":\"16px\"},attrs:{\"type\":\"danger\"},nativeOn:{\"click\":function($event){_vm.removeAll($event)}}},[_vm._v(\"删   除\")]):_c('x-button',{staticStyle:{\"font-size\":\"16px\"},attrs:{\"type\":\"primary\"},nativeOn:{\"click\":function($event){_vm.gotoPay($event)}}},[_vm._v(\"去结账\")])],1),_vm._v(\" \"),_c('prod-sku',{attrs:{\"visible\":!!_vm.skuCartItem,\"sku-model\":_vm.skuModel,\"buttons\":['confirm']},on:{\"visible-change\":_vm.skuVisibleChange,\"confirm\":_vm.onSkuConfirm},model:{value:(_vm.skuValue),callback:function ($$v) {_vm.skuValue=$$v},expression:\"skuValue\"}})]:[_c('p',{staticClass:\"cart-page-empty\"},[_c('img',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"src\":\"/static/icon/img_shopping_cart.png\",\"alt\":\"没有商品\"}}),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('span',[_vm._v(\"购物车空空的哟～您可以\")]),_vm._v(\" \"),_c('br'),_c('br'),_vm._v(\" \"),_c('x-button',{attrs:{\"type\":\"primary\",\"inline\":\"\",\"pill\":\"\"},nativeOn:{\"click\":function($event){_vm.$router.push({ path: '/product/list' })}}},[_vm._v(\"随便逛逛\")])],1)]],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.5.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-b609b5a2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.5.0@vue-loader/lib/selector.js?type=template&index=0!./src/views/cart/cart.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b609b5a2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/selector?type=styles&index=0!./cart.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/selector?type=script&index=0!./cart.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b609b5a2\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/selector?type=template&index=0!./cart.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/cart/cart.vue\n// module id = null\n// module chunks = ","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/_css-loader@0.28.7@css-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b609b5a2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.5.0@vue-loader/lib/selector.js?type=styles&index=0!./cart.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/_vue-style-loader@3.0.3@vue-style-loader/lib/addStylesClient.js\")(\"14e4e28c\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/_vue-style-loader@3.0.3@vue-style-loader!./node_modules/_css-loader@0.28.7@css-loader?{\"sourceMap\":true}!./node_modules/_vue-loader@13.5.0@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-b609b5a2\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/_vue-loader@13.5.0@vue-loader/lib/selector.js?type=styles&index=0!./src/views/cart/cart.vue\n// module id = 5aMo\n// module chunks = 4","exports = module.exports = require(\"../../../node_modules/_css-loader@0.28.7@css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n.cart-page {\\n}\\n.cart-page .x-icon.x-checkbox {\\n  width: 20px;\\n  height: 20px;\\n}\\n.cart-item {\\n  position: relative;\\n  background-color: #fff;\\n}\\n.cart-item-content {\\n  margin-left: 0.86rem;\\n}\\n.cart-item .x-button.cart-item-remove {\\n  height: 100%;\\n  width: 100%;\\n}\\n.cart-item-checkbox {\\n  position: absolute;\\n  top: 50%;\\n  -webkit-transform: translateY(-50%);\\n          transform: translateY(-50%);\\n}\\n.swipe-cell-list {\\n  overflow: hidden;\\n}\\n.swipe-cell-item {\\n  position: relative;\\n}\\n.swipe-cell-content {\\n  width: 100%;\\n}\\n.swipe-cell-right {\\n  position: absolute;\\n  left: 100%;\\n  top: 0;\\n  bottom: 0;\\n  width: 100px;\\n}\\n.cart-page-empty {\\n  text-align: center;\\n  font-size: 14px;\\n  color: #999999;\\n  padding-top: 120px;\\n}\\n.cart-page-empty .x-button {\\n  font-size: 16px;\\n  padding: 0 0.48rem;\\n  height: 0.8rem;\\n  line-height: 0.8rem;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"E:/dev/wemall/src/views/cart/cart.vue\"],\"names\":[],\"mappings\":\";AACA;CACC;AACD;EACE,YAAY;EACZ,aAAa;CACd;AACD;EACE,mBAAmB;EACnB,uBAAuB;CACxB;AACD;EACE,qBAAqB;CACtB;AACD;EACE,aAAa;EACb,YAAY;CACb;AACD;EACE,mBAAmB;EACnB,SAAS;EACT,oCAAoC;UAC5B,4BAA4B;CACrC;AACD;EACE,iBAAiB;CAClB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,YAAY;CACb;AACD;EACE,mBAAmB;EACnB,WAAW;EACX,OAAO;EACP,UAAU;EACV,aAAa;CACd;AACD;EACE,mBAAmB;EACnB,gBAAgB;EAChB,eAAe;EACf,mBAAmB;CACpB;AACD;EACE,gBAAgB;EAChB,mBAAmB;EACnB,eAAe;EACf,oBAAoB;CACrB\",\"file\":\"cart.vue\",\"sourcesContent\":[\"\\n.cart-page {\\n}\\n.cart-page .x-icon.x-checkbox {\\n  width: 20px;\\n  height: 20px;\\n}\\n.cart-item {\\n  position: relative;\\n  background-color: #fff;\\n}\\n.cart-item-content {\\n  margin-left: 0.86rem;\\n}\\n.cart-item .x-button.cart-item-remove {\\n  height: 100%;\\n  width: 100%;\\n}\\n.cart-item-checkbox {\\n  position: absolute;\\n  top: 50%;\\n  -webkit-transform: translateY(-50%);\\n          transform: translateY(-50%);\\n}\\n.swipe-cell-list {\\n  overflow: hidden;\\n}\\n.swipe-cell-item {\\n  position: relative;\\n}\\n.swipe-cell-content {\\n  width: 100%;\\n}\\n.swipe-cell-right {\\n  position: absolute;\\n  left: 100%;\\n  top: 0;\\n  bottom: 0;\\n  width: 100px;\\n}\\n.cart-page-empty {\\n  text-align: center;\\n  font-size: 14px;\\n  color: #999999;\\n  padding-top: 120px;\\n}\\n.cart-page-empty .x-button {\\n  font-size: 16px;\\n  padding: 0 0.48rem;\\n  height: 0.8rem;\\n  line-height: 0.8rem;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_css-loader@0.28.7@css-loader?{\"sourceMap\":true}!./node_modules/_vue-loader@13.5.0@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-b609b5a2\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/_vue-loader@13.5.0@vue-loader/lib/selector.js?type=styles&index=0!./src/views/cart/cart.vue\n// module id = yYPl\n// module chunks = 4"],"sourceRoot":""}