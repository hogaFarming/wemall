webpackJsonp([27],{Eh9J:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s={data:function(){return{orderStatus:-1,nextPage:"",queries:{},total:0,list:[],tabs:[{label:"全部",id:-1},{label:"待付款",id:0},{label:"待发货",id:1},{label:"待收货",id:2},{label:"待评价",id:3}]}},watch:{orderStatus:function(t,i){this.queryList()}},computed:{infiniteScrollDisabled:function(){return!this.nextPage}},mounted:function(){this.queryList()},methods:{loadMore:function(){this.queryList(this.nextPage)},queryList:function(t){var i=this,e=this.orderStatus,s=t||{url:"/api/orders",params:{status:-1===e?void 0:e,comment_status:3===e?0:void 0}};this.$http.withLoading(s).then(function(t){1===t.list.current_page?i.list=t.list.data:i.list=i.list.concat(t.list.data),i.total=t.list.total,i.nextPage=t.list.next_page_url})},toggleList:function(t){console.log(t)},gotoDetail:function(t){this.$router.push("/order/"+t.id)},deleteOrder:function(t){var i=this;this.$messagebox.confirm("确认删除？").then(function(e){"cancel"!==e&&i.$http.withLoading({url:"/api/orders/"+t.id,method:"delete"}).then(function(e){i.$toast("删除成功"),i.list=i.list.filter(function(i){return i!==t})})})},gotoPay:function(t){this.$router.push({path:"/cart/pay",query:{orderid:t.id}})},cancelOrder:function(t){var i=this;this.$messagebox.confirm("确认取消？").then(function(e){"cancel"!==e&&i.$http.withLoading({url:"/api/order/cancel/"+t.id,method:"put"}).then(function(e){i.$toast("取消成功"),t.status=7})})},confirmOrder:function(t){var i=this;this.$messagebox.confirm("确认收货？").then(function(e){"cancel"!==e&&i.$http.withLoading({url:"/api/order/receipts",data:{order_id:t.id},method:"post"}).then(function(e){i.$toast("收货成功"),i.list=i.list.filter(function(i){return i!==t})})})},gotoComment:function(t){this.$router.push("/order/"+t.id+"/comment")},gotoDelivery:function(t){this.$router.push("/order/"+t.id+"/delivery")}}},n={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"page page-order-list"},[e("x-navbar",{staticClass:"mgb",model:{value:t.orderStatus,callback:function(i){t.orderStatus=i},expression:"orderStatus"}},t._l(t.tabs,function(i){return e("mt-tab-item",{key:i.id,attrs:{id:i.id}},[t._v(t._s(i.label))])})),t._v(" "),t.list.length?e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"order-list",attrs:{"infinite-scroll-disabled":"infiniteScrollDisabled","infinite-scroll-distance":"10"}},t._l(t.list,function(i){return e("div",{staticClass:"mod order mgb"},[e("x-cell",{attrs:{bordered:""},nativeOn:{click:function(e){t.gotoDetail(i)}}},[t._v("\n        订单编号："+t._s(i.order_sn)+"\n        "),e("span",{staticClass:"primary",attrs:{slot:"right"},slot:"right"},[t._v(t._s(t._f("orderStatus")(i.status)))])]),t._v(" "),t._l(i.goods,function(i){return e("x-media-object",{key:i.id,staticClass:"bdb",attrs:{pic:i.goods_cover,padding:""}},[t._v("\n        "+t._s(i.goods_name)+"\n        "),e("div",{attrs:{slot:"secondary"},slot:"secondary"},[t._v(t._s(t._f("goodsSkuName")(i)))]),t._v(" "),e("x-money",{attrs:{slot:"bottom-left",value:i.sale_price},slot:"bottom-left"}),t._v(" "),e("span",{attrs:{slot:"bottom-right"},slot:"bottom-right"},[t._v("x"+t._s(i.num))])],1)}),t._v(" "),e("div",{staticClass:"mod_pd bdb order-sum"},[t._v("\n        共 "+t._s(i.total_num)+" 件商品，合计： "),e("x-money",{attrs:{value:i.total_price}})],1),t._v(" "),1!==i.status?e("div",{staticClass:"text-right order-btns"},[3===i.status||5===i.status||7===i.status?e("x-button",{attrs:{pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.deleteOrder(i)}}},[t._v("删除订单")]):t._e(),t._v(" "),0===i.status?e("x-button",{attrs:{pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.cancelOrder(i)}}},[t._v("取消订单")]):t._e(),t._v(" "),2===i.status?e("x-button",{attrs:{pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.confirmOrder(i)}}},[t._v("确认收货")]):t._e(),t._v(" "),3===i.status&&0===i.comment_status?e("x-button",{attrs:{pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.gotoComment(i)}}},[t._v("评价订单")]):t._e(),t._v(" "),2===i.status||3===i.status?e("x-button",{attrs:{pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.gotoDelivery(i)}}},[t._v("查看物流")]):t._e(),t._v(" "),0===i.status?e("x-button",{attrs:{type:"primary",pill:"",inline:"",ghost:""},nativeOn:{click:function(e){t.gotoPay(i)}}},[t._v("去付款")]):t._e()],1):t._e()],2)})):e("div",{staticClass:"order-list--empty"},[e("p",{staticStyle:{color:"#999999","padding-left":"0.48rem","padding-bottom":"0.3rem"}},[t._v("暂无数据")])])],1)},staticRenderFns:[]},o=e("/Xao")(s,n,!1,null,null,null);i.default=o.exports}});
//# sourceMappingURL=27.12bbda315eefd7d840b9.js.map