webpackJsonp([15],{"1Vmy":function(t,s,e){(t.exports=e("BkJT")(!0)).push([t.i,'\n.page {\n  font-size: 14px;\n}\n.address {\n  position: relative;\n}\n.address-default-flag {\n  display: none;\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 40px;\n  height: 40px;\n  background-image: url("/static/icon/ic_default.png");\n}\n.address-is-default .address-default-flag {\n  display: block;\n}\n.address-border {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 3px;\n  background-image: url("/static/icon/ic_mail_mark.png");\n  background-repeat: repeat-x;\n}\n.cart-popup {\n  width: 100%;\n}\n.cart-popup-title {\n  text-align: center;\n}\n',"",{version:3,sources:["E:/dev/wemall/src/views/cart/cart-order.vue"],names:[],mappings:";AACA;EACE,gBAAgB;CACjB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,cAAc;EACd,mBAAmB;EACnB,QAAQ;EACR,OAAO;EACP,YAAY;EACZ,aAAa;EACb,qDAAqD;CACtD;AACD;EACE,eAAe;CAChB;AACD;EACE,mBAAmB;EACnB,UAAU;EACV,QAAQ;EACR,YAAY;EACZ,YAAY;EACZ,uDAAuD;EACvD,4BAA4B;CAC7B;AACD;EACE,YAAY;CACb;AACD;EACE,mBAAmB;CACpB",file:"cart-order.vue",sourcesContent:['\n.page {\n  font-size: 14px;\n}\n.address {\n  position: relative;\n}\n.address-default-flag {\n  display: none;\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 40px;\n  height: 40px;\n  background-image: url("/static/icon/ic_default.png");\n}\n.address-is-default .address-default-flag {\n  display: block;\n}\n.address-border {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 3px;\n  background-image: url("/static/icon/ic_mail_mark.png");\n  background-repeat: repeat-x;\n}\n.cart-popup {\n  width: 100%;\n}\n.cart-popup-title {\n  text-align: center;\n}\n'],sourceRoot:""}])},MIrn:function(t,s,e){var a=e("1Vmy");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("8bSs")("968e8226",a,!0)},XU50:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("3cXf"),i=e.n(a),n=e("4YfN"),r=e.n(n),o={data:function(){return{loading:!0,query:{cart:this.$route.query.cart||void 0,goods_id:this.routeQueryId("goods_id"),sku_id:this.routeQueryId("sku_id"),num:this.routeQueryId("num"),address_id:this.routeQueryId("address_id")},addressList:[],coupon:[],capital:{},goodsList:[],goodsTotalNum:0,orderData:{},desc:"",ticketsVisible:!1,prodPopupVisible:!1,useIntegral:!1}},computed:{address:function(){var t=this.orderData&&this.orderData.user_address;if(t){var s=t.province,e=t.city,a=t.district,i=t.address,n=t.id,r=[s,e,a,i].filter(function(t){return!!t}).join("");t.text=r;var o=this.addressList.filter(function(t){return t.id===n})[0];o&&(t.is_default=o.is_default)}return t},isFormReady:function(){return!!this.address}},mounted:function(){this.pageInit()},methods:{pageInit:function(){var t=this;this.fetchOrderData().then(function(){t.loading=!1})},fetchAddress:function(){},fetchOrderData:function(){var t=this,s=r()({},this.query,{cart:this.getCartArr()});return s.cart.length||(s.cart=void 0),this.$http.withLoading({url:"/api/order/confirms",data:s,method:"post"}).then(function(s){t.addressList=s.data.address,t.coupon=s.data.coupon,t.capital=s.data.capital,t.goodsList=s.data.goods_data.map(function(t){var s=[];if(t.sku_name_arr)for(var e in t.sku_name_arr)s.push(t.sku_name_arr[e]);return r()({},t,{sku_show_name:s.join(" ")})}),t.goodsTotalNum=s.data.goods_total_num,t.orderData=s.data.order_data})},toggleAddress:function(){var t=this.query;t.type="order";var s={desc:this.desc};t.data=encodeURIComponent(i()(this.$utils.deleteObj(s))),this.$router.push({path:"/my/address",query:t})},showTickets:function(){this.coupon.length&&(this.ticketsVisible=!0)},submitOrder:function(){var t=this,s=this.getCartArr(),e=r()({},this.query,{cart:s.length?s:void 0,address_id:this.address.id,desc:this.desc||void 0,is_invoice:0});this.useIntegral&&(e.integral=this.capital.can_use_integral),this.$http.withLoading({url:"/api/orders",data:e,method:"post"}).then(function(s){s.data.pay_done?t.$router.replace({path:"/order/paystatus",query:{orderid:s.data.order_id}}):t.$router.replace({path:"/order/pay",query:{orderid:s.data.order_id}})})},ticketConfirm:function(){},getCartArr:function(){return this.query.cart?this.query.cart.split(",").map(function(t){return{cart_id:t}}):[]}}},d={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"page order-confirm-page"},[t.address?e("x-cell",{staticClass:"address mgb",class:{"address-is-default":!!t.address.is_default},attrs:{"icon-right":"next_page"},nativeOn:{click:function(s){t.toggleAddress(s)}}},[e("x-media-object",{staticClass:"address-location",attrs:{icon:"address",padding:!1,size:"27px",push:"22px"}},[e("p",{staticClass:"address-concat"},[e("span",[t._v(t._s(t.address.consignee))]),t._v(" "),e("span",[t._v(t._s(t.address.phone))])]),t._v(" "),e("p",[t._v(t._s(t.address.text))])]),t._v(" "),e("div",{staticClass:"address-default-flag"}),t._v(" "),e("div",{staticClass:"address-border"})],1):e("x-cell",{staticClass:"mgb bdb",attrs:{icon:"select_ele","icon-right":"next_page"},nativeOn:{click:function(s){t.toggleAddress(s)}}},[t._v("\n    请填写收货地址\n  ")]),t._v(" "),e("div",{staticClass:"goods-list"},t._l(t.goodsList,function(s){return e("x-media-object",{key:s.id,staticClass:"bdb",attrs:{pic:s.goods_cover,padding:""}},[t._v("\n      "+t._s(s.goods_title)+"\n      "),e("span",{attrs:{slot:"secondary"},slot:"secondary"},[t._v(t._s(s.sku_show_name))]),t._v(" "),e("x-money",{attrs:{slot:"bottom-left",color:"red",value:s.sale_price},slot:"bottom-left"}),t._v(" "),e("span",{attrs:{slot:"bottom-right"},slot:"bottom-right"},[t._v("x"+t._s(s.num))])],1)})),t._v(" "),e("x-field",{staticClass:"mgb",attrs:{label:"买家留言",placeholder:"您可以给商家留言"},model:{value:t.desc,callback:function(s){t.desc=s},expression:"desc"}}),t._v(" "),e("x-cell",{attrs:{title:"运费 (快递)"}},[e("x-money",{staticStyle:{"font-size":"16px"},attrs:{slot:"right",value:t.orderData.express_price,size:"small"},slot:"right"})],1),t._v(" "),e("x-cell",{staticClass:"bdb",attrs:{title:"优惠券","icon-right":"next_page"},nativeOn:{click:function(s){t.showTickets(s)}}},[t.loading?e("span"):t.coupon.length?e("span",{attrs:{slot:"right"},slot:"right"},[t._v("有可用优惠券")]):e("span",{attrs:{slot:"right"},slot:"right"},[t._v("无可用优惠券")])]),t._v(" "),e("x-cell",{staticClass:"mgb"},[e("p",{staticClass:"black-3",staticStyle:{"margin-bottom":"5px"}},[t._v("当前积分："+t._s(t.capital.integral))]),t._v(" "),e("p",[t._v("可用"+t._s(t.capital.integral)+"积分抵扣\n      "),e("x-money",{attrs:{value:t.capital.integral_price}})],1),t._v(" "),e("div",{attrs:{slot:"right"},slot:"right"},[e("mt-switch",{model:{value:t.useIntegral,callback:function(s){t.useIntegral=s},expression:"useIntegral"}})],1)]),t._v(" "),e("x-fixed-bottom",{staticStyle:{"font-size":"14px"}},[e("x-cell",{attrs:{slot:"content"},slot:"content"},[t._v("\n      共 "+t._s(t.goodsTotalNum)+" 件商品\n      "),e("div",{attrs:{slot:"right"},slot:"right"},[t._v("\n        实付:\n        "),e("x-money",{attrs:{value:t.orderData.actual_price,color:"red"}})],1)]),t._v(" "),e("x-button",{attrs:{type:"primary",disabled:!t.isFormReady},nativeOn:{click:function(s){t.submitOrder(s)}}},[t._v("提交订单")])],1),t._v(" "),e("mt-popup",{staticClass:"cart-popup",attrs:{position:"bottom"},model:{value:t.ticketsVisible,callback:function(s){t.ticketsVisible=s},expression:"ticketsVisible"}},[e("x-cell",{staticClass:"cart-popup-title bdb"},[t._v("\n      使用优惠券\n      "),e("x-icon",{attrs:{slot:"right",type:"close"},nativeOn:{click:function(s){t.ticketsVisible=!1}},slot:"right"})],1),t._v(" "),e("ticket",{staticStyle:{margin:"0.48rem"}}),t._v(" "),e("x-button",{staticStyle:{"margin-top":"0.8rem"},attrs:{size:"full",type:"primary"},nativeOn:{click:function(s){t.ticketConfirm(s)}}},[t._v("确定")])],1),t._v(" "),e("mt-popup",{staticClass:"cart-popup",attrs:{position:"bottom"},model:{value:t.prodPopupVisible,callback:function(s){t.prodPopupVisible=s},expression:"prodPopupVisible"}},[e("x-cell",{staticClass:"cart-popup-title bdb"},[t._v("\n      选择生日券生效商品\n      "),e("x-icon",{attrs:{slot:"right",type:"close"},nativeOn:{click:function(s){t.ticketsVisible=!1}},slot:"right"})],1),t._v(" "),e("x-media-object",{staticClass:"bdb",attrs:{pic:"/static/img/order.png",padding:""}},[t._v("\n      2017年新款茶灵春季面膜50ml 提亮肌肤快速美容透白美丽快速美容\n      "),e("span",{attrs:{slot:"secondary"},slot:"secondary"},[t._v("提亮肌肤50ML")]),t._v(" "),e("x-money",{attrs:{slot:"bottom-left",value:588,color:"red"},slot:"bottom-left"})],1),t._v(" "),e("x-button",{staticStyle:{"margin-top":"0.8rem"},attrs:{size:"full",type:"primary"},nativeOn:{click:function(s){t.ticketConfirm(s)}}},[t._v("确定")])],1)],1)},staticRenderFns:[]},l=e("/Xao")(o,d,!1,function(t){e("MIrn")},null,null);s.default=l.exports}});
//# sourceMappingURL=15.9df1a81b49b172bd393a.js.map