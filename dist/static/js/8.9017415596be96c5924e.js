webpackJsonp([8],{RADo:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={data:function(){return{nextPage:"",searchText:this.$route.query.goods_name||"",currentTab:1,priceDir:1,selectedBrands:void 0,startPrice:void 0,endPrice:void 0,queries:{},total:0,list:[],filterVisible:!1,filterBrands:[],categories:[]}},mounted:function(){this.search(this.searchText)},computed:{infiniteScrollDisabled:function(){return!this.nextPage}},methods:{search:function(){this.queries={goods_name:this.searchText||void 0,goods_brand_id:this.selectedBrands,status:1===this.currentTab?2:3,sort:this.priceDir},this.startPrice>0&&(this.queries.start_price=100*this.startPrice),this.endPrice>0&&(this.queries.end_price=100*this.endPrice,this.startPrice||(this.queries.start_price=0)),this.queryList()},loadMore:function(){this.queryList(this.nextPage)},reloadList:function(){this.queryList()},queryList:function(t){var e=this,i={url:t||"/api/goodses",params:t?void 0:this.queries};this.queries.goods_name&&this.$service.pushHistorySearch(this.queries.goods_name),this.$http.withLoading(i).then(function(t){1===t.list.current_page?e.list=t.list.data:e.list=e.list.concat(t.list.data),e.total=t.list.total,e.nextPage=t.list.next_page_url})},queryCategories:function(){var t=this;return this.$http.withLoading("/api/goods/categorys").then(function(e){t.categories=e.list})},onTabChange:function(t){switch(t){case 1:if(1===this.currentTab)return;this.currentTab=1,this.search();break;case 2:2===this.currentTab?this.priceDir=1===this.priceDir?2:1:this.currentTab=2,this.search();break;case 3:this.showFilter()}},showFilter:function(){var t=this;this.queryCategories().then(function(){t.filterVisible=!0})},onFilterVisibleChange:function(t){this.filterVisible=t},confirmFilter:function(){this.$refs.startPrice.value=this.startPrice=this.startPrice>0?this.startPrice:"",this.$refs.endPrice.value=this.endPrice=this.endPrice>0?this.endPrice:"",this.filterVisible=!1,this.search()},resetFilter:function(){this.selectedBrands=[],this.$refs.startPrice.value="",this.$refs.endPrice.value=""},toProdDetail:function(t){this.$router.push("/product/"+t.id)}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("x-cell",{staticClass:"bdb"},[i("x-search",{on:{search:t.search},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1),t._v(" "),i("x-navbar",{staticClass:"mgb",attrs:{value:t.currentTab},on:{input:t.onTabChange}},[i("mt-tab-item",{attrs:{id:1}},[t._v("销量")]),t._v(" "),i("mt-tab-item",{attrs:{id:2}},[t._v("价格 "),i("x-icon",{attrs:{type:"arrow_price"}})],1),t._v(" "),i("mt-tab-item",{attrs:{id:3}},[t._v("筛选 "),i("x-icon",{attrs:{type:"filter"}})],1)],1),t._v(" "),i("div",[t.list.length?i("div",[i("div",{staticClass:"black-3",staticStyle:{padding:"0 0.27rem 0.32rem"}},[t._v("\n        "+t._s(t.queries.goods_name)+"-找到 "+t._s(t.total)+" 个结果\n      ")]),t._v(" "),i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"search-result",attrs:{"infinite-scroll-disabled":"infiniteScrollDisabled","infinite-scroll-distance":"10"}},t._l(t.list,function(e){return i("x-card",{key:e.id,staticClass:"result-item",attrs:{pic:t.thumbnail(e.cover,300),"pic-width":"4.53rem","pic-height":"4.2667rem"},nativeOn:{click:function(i){t.toProdDetail(e)}}},[i("span",[t._v(t._s(e.name))]),t._v(" "),i("x-money",{attrs:{slot:"meta",value:e.sale_price,color:"red"},slot:"meta"})],1)}))]):t._e()]),t._v(" "),i("mt-popup",{staticClass:"filter-popup",attrs:{position:"right",value:t.filterVisible},on:{input:t.onFilterVisibleChange}},[i("div",{staticClass:"filter-popup-content"},[t._l(t.categories,function(e){return i("div",{staticClass:"filter-section"},[i("div",{staticClass:"filter-section-title"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"filter-section-body"},[i("x-label-radio",{attrs:{options:e.children,value:e.next_selected,keys:["name","id"]},on:{input:function(t){e.next_selected=t}}})],1)])}),t._v(" "),i("div",{staticClass:"filter-section"},[i("div",{staticClass:"filter-section-title"},[t._v("价格区间")]),t._v(" "),i("div",{staticClass:"filter-section-body"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.startPrice,expression:"startPrice"}],ref:"startPrice",staticClass:"filter-price-input",attrs:{type:"number",placeholder:"最低价"},domProps:{value:t.startPrice},on:{input:function(e){e.target.composing||(t.startPrice=e.target.value)}}}),t._v(" "),i("span",{staticStyle:{margin:"0 0.27rem"}},[t._v("-")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.endPrice,expression:"endPrice"}],ref:"endPrice",staticClass:"filter-price-input",attrs:{type:"number",placeholder:"最高价"},domProps:{value:t.endPrice},on:{input:function(e){e.target.composing||(t.endPrice=e.target.value)}}})])])],2),t._v(" "),i("div",{staticClass:"filter-btns"},[i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.resetFilter(e)}}},[t._v("重置")]),t._v(" "),i("x-button",{attrs:{type:"danger"},nativeOn:{click:function(e){t.confirmFilter(e)}}},[t._v("确认")])],1)])],1)},staticRenderFns:[]},s=i("/Xao")(n,r,!1,function(t){i("Ykev")},null,null);e.default=s.exports},Ykev:function(t,e,i){var n=i("wBQo");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("8bSs")("daccb7f6",n,!0)},wBQo:function(t,e,i){(t.exports=i("BkJT")(!0)).push([t.i,"\n.search-result {\n  overflow: hidden;\n  padding: 0 0.27rem;\n  /*margin-bottom: -0.25rem;*/\n}\n.result-item {\n  float: left;\n  margin-right: 0.4rem;\n  margin-bottom: 0.25rem;\n}\n.result-item:nth-child(2n) {\n  margin-right: 0;\n}\n.filter-popup {\n  width: 80%;\n  height: 100%;\n  background-color: #ffffff;\n  font-size: 14px;\n}\n.filter-popup-content {\n  height: 100%;\n  overflow: auto;\n  padding-bottom: 70px;\n}\n.filter-section {\n  padding: 0.5333rem 0.32rem;\n  border-top: 1px solid #f0f0f0;\n}\n.filter-section:first-child {\n  border-top: none;\n}\n.filter-section-title {\n  line-height: 20px;\n  margin-bottom: 0.2667rem;\n  color: #999999;\n}\n.filter-btns {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.filter-btns > button {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.filter-price-input {\n  border: 1px solid #CCCCCC;\n  border-radius: 8px;\n  outline: none;\n  width: 2.67rem;\n  font-size: 12px;\n  line-height: 17px;\n  padding: 0.1067rem 0.27rem;\n}\n","",{version:3,sources:["E:/dev/wemall/src/views/product/list.vue"],names:[],mappings:";AACA;EACE,iBAAiB;EACjB,mBAAmB;EACnB,4BAA4B;CAC7B;AACD;EACE,YAAY;EACZ,qBAAqB;EACrB,uBAAuB;CACxB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,WAAW;EACX,aAAa;EACb,0BAA0B;EAC1B,gBAAgB;CACjB;AACD;EACE,aAAa;EACb,eAAe;EACf,qBAAqB;CACtB;AACD;EACE,2BAA2B;EAC3B,8BAA8B;CAC/B;AACD;EACE,iBAAiB;CAClB;AACD;EACE,kBAAkB;EAClB,yBAAyB;EACzB,eAAe;CAChB;AACD;EACE,mBAAmB;EACnB,UAAU;EACV,QAAQ;EACR,SAAS;EACT,qBAAqB;EACrB,qBAAqB;EACrB,cAAc;CACf;AACD;EACE,oBAAoB;MAChB,YAAY;UACR,QAAQ;CACjB;AACD;EACE,0BAA0B;EAC1B,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB,2BAA2B;CAC5B",file:"list.vue",sourcesContent:["\n.search-result {\n  overflow: hidden;\n  padding: 0 0.27rem;\n  /*margin-bottom: -0.25rem;*/\n}\n.result-item {\n  float: left;\n  margin-right: 0.4rem;\n  margin-bottom: 0.25rem;\n}\n.result-item:nth-child(2n) {\n  margin-right: 0;\n}\n.filter-popup {\n  width: 80%;\n  height: 100%;\n  background-color: #ffffff;\n  font-size: 14px;\n}\n.filter-popup-content {\n  height: 100%;\n  overflow: auto;\n  padding-bottom: 70px;\n}\n.filter-section {\n  padding: 0.5333rem 0.32rem;\n  border-top: 1px solid #f0f0f0;\n}\n.filter-section:first-child {\n  border-top: none;\n}\n.filter-section-title {\n  line-height: 20px;\n  margin-bottom: 0.2667rem;\n  color: #999999;\n}\n.filter-btns {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.filter-btns > button {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.filter-price-input {\n  border: 1px solid #CCCCCC;\n  border-radius: 8px;\n  outline: none;\n  width: 2.67rem;\n  font-size: 12px;\n  line-height: 17px;\n  padding: 0.1067rem 0.27rem;\n}\n"],sourceRoot:""}])}});
//# sourceMappingURL=8.9017415596be96c5924e.js.map